# kwaf
Web application firewall as a service

## Architecture

```ditaa
+---------------------------------------------------------------------------------+
|                                                   Web Application Firewall (WAF)|
|   +    +    +                                                                   |
|   |    |    |                                                                   |
|   v    v    v                                                                   |
| +-------------+                              proxied http call                  |
| | +---------+ |                                      +                          |
| | | nginx   | |<-----------------------------------+ |                          |
| | | HAProxy | |        read logs                   | |                          |
| | +---------+ |                                    | |                          |
| +---+----+----+                                    | |                          |
|     |    |                                         | |                          |
|     v    v                                         | |                          |
| +------------+                                     | |                          |
| |    API     |                                     | |                          |
| +------------+                                     | v                          |
|                                              +------------+                     |
|                                              |kwaf-ingress|                     |
|                                              +-----+------+                     |
|                                                    |                            |
|                                                    |                            |
|                                                    |                            |
|                                                    | push event                 |
|                                                    |                            |
|                                                    |                            |
|                                                    v                            |
|              +--------------+                  +-----------------------------+  |
|    counters  | redis        |                  |      kwaf                   |  |
|              | hazelcast    |                  | POST /events                |  |
|              | apache ignite|     persist      | GET /ratings                |  |
|              |              |<-----------------+ GET /ratings?user_id=userID |  |
|    logs      | PostgreSQL   |                  |                             |  |
|              +--------------+                  +-----------------------------+  |
|                                                                                 |
+---------------------------------------------------------------------------------+
``` 
