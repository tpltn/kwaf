# kwaf
Web application firewall as a service

## Architecture

```ditaa
+---------------------------------------------------------------------------------+
|                                                   Web Application Firewall (WAF)|
|   +    +    +                                                                   |
|   |    |    |                                                                   |
|   v    v    v                                                                   |
| +-------------+                              proxied http call                  |
| | +---------+ |                                      +                          |
| | | nginx   | |<-----------------------------------+ |                          |
| | | HAProxy | |        read logs                   | |                          |
| | +---------+ |                                    | |                          |
| +---+----+----+                                    | |                          |
|     |    |                                         | |                          |
|     v    v                                         | |                          |
| +------------+                                     | |                          |
| |    API     |                                     | |                          |
| +------------+                                     | v                          |
|                                              +------------+                     |
|                                              |kwaf-ingress|                     |
|                                              +-----+------+                     |
|                                                    |                            |
|                                                    |                            |
|                                                    |                            |
|                                                    | push event                 |
|                                                    |                            |
|                                                    |                            |
|                                                    v                            |
|              +--------------+                  +-------------------------+      |
|    counters  | redis        |                  |      kwaf               |      |
|              | hazelcast    |                  | /createEvent            |      |
|              | apache ignite|     persist      | /ratings                |      |
|              |              |<-----------------+ /ratings/?user_id=userID|      |
|    logs      | PostgreSQL   |                  |                         |      |
|              +--------------+                  +-------------------------+      |
|                                                                                 |
+---------------------------------------------------------------------------------+
``` 
